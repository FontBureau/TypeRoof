<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title> - Documentation - TypeRoof</title>
        <meta name="viewport" content="initial-scale=1,shrink-to-fit=no">
        <link rel="stylesheet" href="../../lib/css/shell.css">
    </head>
    <body class="typeroof-docs">
        <div class="wrapper">
            <header>
                <h1>TypeRoof</h1>
            </header>
            <div class="typeroof-ui_sidebar">

                <h3>Content</h3>
                <nav>
                    <ul><li><a href="/TypeRoof/docs/">Landing Page</a><ul><li><a href="/TypeRoof/docs/usage/">User Kit</a></li>
<li><a href="/TypeRoof/docs/development/">Developer Kit</a></li></ul></li>
<li><a href="/TypeRoof/docs/states_lib/">States Library</a><ul><li><a href="/TypeRoof/docs/states_lib/demos/">/demos</a></li></ul></li>
<li><a href="/TypeRoof/README/">Project README</a></li></ul>
                </nav>
                <h3>Applications</h3>
                <ul class="typeroof-ui_sidebar-app_links">
                    <li><a href="../../shell">TypeRoof Shell</a></li>
                    <li><a href="../../legacy">TypeRoof Legacy</a></li>
                </ul>
            </div>
            <div class="typeroof-main">
                <div class="typeroof-docs_content"><h1><a id="user-content-serve-live-font-changes-to-typeroof" class="anchor" href="#serve-live-font-changes-to-typeroof" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Serve live font changes to TypeRoof</h1>
<p>This is an example implementation to showcase how TypeRoof can live update
fonts that have changed in a local folder/directory. The idea is for font
editors to pick this up and to provide the feature built in for their users.</p>
<p>For font-editor implementers see the technical documentation at: <a href="https://fontbureau.github.io/TypeRoof/docs/development/live">Developer Kit – Live font changes</a></p>
<h2><a id="user-content-use-locally" class="anchor" href="#use-locally" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Use locally</h2>
<p>If your editor does not implement this or if you just want to try
it out. In the former case, point the web-socket server in Part 1 to the
directory you are saving your font under and skip Part 3.</p>
<p>Part 2, the web-server for the  <code>adapter-ws-to-typeroof.html</code> file,
could be built into the server in Part 1 but one reason for this
is to demonstrate the different roles that are required to make the
updates in TypeRoof work and therefore this has a strong separation.
Let us know if a stand-alone, one stop script, is desirable for you
<a href="https://github.com/FontBureau/TypeRoof/issues">in the issue tracker</a>.</p>
<h2><a id="user-content-install" class="anchor" href="#install" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Install</h2>
<p>This installation procedure recommends to use a python virtual environment
in order to keep the system/user python installation unaffected.</p>
<pre><code># Initialize a python virtual environmnet in the TypeRoof/live directory.
$ ~/path/to/TypeRoof/live &gt; python3 -m venv venv
(venv) $ ~/path/to/TypeRoof/live &gt;

# Activate the virtual environment.
$ ~/path/to/TypeRoof/live &gt; . venv/bin/activate
(venv) $ ~/path/to/TypeRoof/live &gt;

# Install the dependencies into the virtual environment.
(venv) $ ~/path/to/TypeRoof/live &gt; pip install -r requirements.txt
</code></pre>
<h2><a id="user-content-run" class="anchor" href="#run" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Run</h2>
<p>You will need up to three terminal windows to run the separate parts:</p>
<h3><a id="user-content-part-1-the-web-socket-server-observing-font-file-changes" class="anchor" href="#part-1-the-web-socket-server-observing-font-file-changes" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Part 1: The web-socket server observing font file changes.</h3>
<p>This will start a web socket server at <code>ws://localhost:8765/</code> where the
page <code>adapter-ws-to-typeroof.html</code> (see Part 2) can connect to.</p>
<p>You’ll need a directory to observe for font-changes for this. Maybe, to
simply test this, go to step 3 first and run the file rotation.</p>
<pre><code># With the activated virtual environment.

(venv) $ ~/path/to/TypeRoof/live &gt; ./websocket-font-update-server.py .fonts/
</code></pre>
<h3><a id="user-content-part-2-a-simple-web-server-for-adapter-ws-to-typeroofhtml" class="anchor" href="#part-2-a-simple-web-server-for-adapter-ws-to-typeroofhtml" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Part 2: a simple web-server for <code>adapter-ws-to-typeroof.html</code></h3>
<p>In order to connect between the web-socket — or any other source of font changes —
and TypeRoof we load a web-site that in turn opens TypeRoof as a popup. That
relation enables the usage of the <code>window.postMessage</code> API to send messages
to TypeRoof.</p>
<pre><code># You don't need the virtual environment for this

$ ~/path/to/TypeRoof/live &gt; python3 -m http.server
Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...
</code></pre>
<p>Open <a href="http://0.0.0.0:8000/adapter-ws-to-typeroof.html">http://0.0.0.0:8000/adapter-ws-to-typeroof.html</a>
in your browser. NOTE: the port number (<code>8000</code>) and maybe IO-adress may
differ in your instance, look at the information given by the command.</p>
<p>This will connect to the web-socket server and open TypeRoof as a PopUp
(you’ll have to allow that in your browser and maybe reload the page again).
In the window of the <code>adapter-ws-to-typeroof.html</code> page you’ll also be
able to observe the currently provided fonts and how they change.</p>
<p>You’ll have to select the font/fonts that is/are updated in TypeRoof
yourself once.</p>
<h3><a id="user-content-part-3-file_rotationpy" class="anchor" href="#part-3-file_rotationpy" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Part 3: <code>file_rotation.py</code></h3>
<p>This is optional as a demo. To observe file changes created e.g. by a
font-editor, Part 1 and Part 2 are  sufficient.</p>
<p>If you don’t have a source directory for a changing font file that you want
to see updated in TypeRoof, i.e. a font updated by an editor or build process,
this script can “rotate” all font files from a source directory into a single
file in a target directory and thus trigger file-change events.</p>
<pre><code># With the activated virtual environment.

# Rotate the files in &quot;../lib/assets/fonts/*&quot; as &quot;live-font.ttf&quot; in &quot;the&quot;
# ./.fonts directory every two seconds. NOTE especially the `-f` flag
# that is meant as safeguard to prevent accidental change to essential
# data.
(venv) $ ~/path/to/TypeRoof/live &gt; ./file_rotation.py -f -s 2 -t live-font.ttf ./.fonts/ ../lib/assets/fonts/*

# There's an online help in the tool:
(venv) $ ~/path/to/TypeRoof/live &gt;  ./file_rotation.py
usage: file_rotation.py [-h] [-t TARGET_FILE_NAME] [-f] [-s SECONDS] target_dir source_files [source_files ...]

Rotate font files between target dir and the source directories.

positional arguments:
  target_dir            Target directory name, will be created. Use --force if it exist and its contents can be overridden.
  source_files          Paths to each source files. Each file path will function as a source for the contents in target dir in rotation.

options:
  -h, --help            show this help message and exit
  -t TARGET_FILE_NAME, --target-file TARGET_FILE_NAME
                        Target file name, must not contain the slash character&quot;/&quot; (default: SampleFont.ttf)
  -f, --force           If target_dir exists, allow to change its contents.
  -s SECONDS, --seconds SECONDS
                        number of seconds between rotations (default: 7)
</code></pre>
</div>
            </div>
            <footer>
                <ul>
                    <li><a href="https://github.com/FontBureau/TypeRoof">Source code on GitHub</a></li><!--
                    --><li><a href="https://github.com/FontBureau/TypeRoof/issues">Bug reports &amp; feature&nbsp;requests</a></li>
                </ul>
            </footer>
        </div> <!-- wrapper -->
    </body>
</html>
