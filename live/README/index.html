<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title> - Documentation - TypeRoof</title>
        <meta name="viewport" content="initial-scale=1,shrink-to-fit=no">
        <link rel="stylesheet" href="../../lib/css/shell.css">
    </head>
    <body class="typeroof-docs">
        <div class="wrapper">
            <header>
                <h1>TypeRoof</h1>
            </header>
            <div class="typeroof-ui_sidebar">

                <h3>Content</h3>
                <nav>
                    <ul><li><a href="/TypeRoof/docs/">Landing Page</a><ul><li><a href="/TypeRoof/docs/usage/">User Kit</a></li>
<li><a href="/TypeRoof/docs/development/">Developer Kit</a></li></ul></li>
<li><a href="/TypeRoof/docs/states_lib/">States Library</a><ul><li><a href="/TypeRoof/docs/states_lib/demos/">/demos</a></li></ul></li>
<li><a href="/TypeRoof/README/">Project README</a></li></ul>
                </nav>
                <h3>Applications</h3>
                <ul class="typeroof-ui_sidebar-app_links">
                    <li><a href="../../shell">TypeRoof Shell</a></li>
                    <li><a href="../../legacy">TypeRoof Legacy</a></li>
                </ul>
            </div>
            <div class="typeroof-main">
                <div class="typeroof-docs_content"><h1><a id="user-content-serve-live-font-changes-to-typeroof" class="anchor" href="#serve-live-font-changes-to-typeroof" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Serve Live Font Changes to TypeRoof</h1>
<p>This is an example implementation to showcase how TypeRoof can live update
fonts that have changed e.g. within a font editor or on your hard-drive.
The idea is for font editors to pick this up and to provide the feature
built in for their users.</p>
<p>For font editor implementers or if you are interested in technical details,
see the technical documentation at: <a href="https://fontbureau.github.io/TypeRoof/docs/development/live">Developer Kit – Live font changes</a></p>
<p>If your font editor does not yet implement font updates in TypeRoof directly
or if you just want to try it out in another scenario you can use these
scripts to monitor fonts in a local folder/directory on your computer and
send update messages to TypeRoof, the <a href="#run-with-websocket">Run with WebSocket</a> example is better suited
for this case, as the polling example has cross-orign limitations and the
polling adapter reqiures a (hard-coded) list of known file names to poll.</p>
<h2><a id="user-content-install" class="anchor" href="#install" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Install</h2>
<p>You need to do this only in order to use the <code>websocket-font-update-server.py</code>
and <code>file_rotation.py</code> scripts.</p>
<p>This installation procedure recommends to use a python virtual environment
in order to keep the system/user python installation unaffected.</p>
<pre><code># Initialize a python virtual environmnet in the TypeRoof/live directory.
$ ~/path/to/TypeRoof/live &gt; python3 -m venv venv
(venv) $ ~/path/to/TypeRoof/live &gt;

# Activate the virtual environment.
$ ~/path/to/TypeRoof/live &gt; . venv/bin/activate
(venv) $ ~/path/to/TypeRoof/live &gt;

# Install the dependencies into the virtual environment.
(venv) $ ~/path/to/TypeRoof/live &gt; pip install -r requirements.txt
</code></pre>
<h2><a id="user-content-adapters-usage" class="anchor" href="#adapters-usage" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Adapters Usage</h2>
<p>In order to connect any source of font changes and TypeRoof we load a
web-page, called an <strong>Adapter,</strong> that in turn opens TypeRoof as a
pop-up. That relation enables the usage of the <code>window.postMessage</code> API
to send messages with font updates from the Adapter to TypeRoof.</p>
<p>At the first time you open an adapter pop-ups will be blocked in your browser.
You’ll have to <strong>allow pop-ups and then reload the page of the adapter</strong> again
to successfully establish the connection.</p>
<p>In the window of the adapter page you’ll also be able to observe the
currently provided fonts and how they change.</p>
<h2><a id="user-content-run-with-websocket" class="anchor" href="#run-with-websocket" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Run with WebSocket</h2>
<p>There are two or three individual steps involved:</p>
<ul>
<li><a href="#websocket-part-1-server">WebSocket Part 1: Server</a></li>
<li><a href="#websocket-part-2-adapter">WebSocket Part 2: Adapter</a></li>
<li>(optionally) <a href="#part-3-file-rotation">Part 3: File Rotation</a></li>
</ul>
<h3><a id="user-content-websocket-part-1-server" class="anchor" href="#websocket-part-1-server" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>WebSocket Part 1: Server</h3>
<p>This will start a WebSocket-server at <code>ws://localhost:8765/</code> where the
page <code>adapter-websocket-to-typeroof.html</code> (see  <a href="#websocket-part-2-adapter">Part 2</a>)
can connect to.</p>
<p>You’ll need a directory to observe for font-changes, to test this, go to
<a href="#part-3-file-rotation">Part 3: File Rotation</a> first and run the file
rotation which will create the <code>fonts</code> directory.</p>
<pre><code># With the activated virtual environment.

(venv) $ ~/path/to/TypeRoof/live &gt; ./websocket-font-update-server.py fonts/
</code></pre>
<h3><a id="user-content-websocket-part-2-adapter" class="anchor" href="#websocket-part-2-adapter" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>WebSocket Part 2: Adapter</h3>
<p>See <a href="#adapters-usage">Adapters Usage</a>.</p>
<h4><a id="user-content-a-using-file" class="anchor" href="#a-using-file" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>A: Using <code>file:///</code></h4>
<p>It’s actually possible to open <code>adapter-websocket-to-typeroof.html</code> without
a local web-server directly from disk with a <code>file://</code>.</p>
<p>Open <code>file:///home/username/path/to/TypeRoof/live/adapter-websocket-to-typeroof.html</code>
(you need to change the path or open the file from your file manager) in you browser.</p>
<h4><a id="user-content-b-using-a-local-web-server" class="anchor" href="#b-using-a-local-web-server" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>B: Using a Local Web-Server</h4>
<p>Alternatively, you can start a simple web-server to deliver the file:</p>
<pre><code># You don't need the virtual environment for this

$ ~/path/to/TypeRoof/live &gt; python3 -m http.server 8000
Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...
</code></pre>
<p>Open <a href="http://0.0.0.0:8000/adapter-websocket-to-typeroof.html">http://0.0.0.0:8000/adapter-websocket-to-typeroof.html</a>
in your browser.</p>
<h4><a id="user-content-c-use-the-online-adapter" class="anchor" href="#c-use-the-online-adapter" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>C: Use the online Adapter</h4>
<p>The adapter is also online at our web site and since WebSockets don’t
require special cross-site allowance, the online adapter should be able
to connect to the server started in <a href="#websocket-part-1-server">WebSocket Part 1: Server</a>.</p>
<p>Open <a href="https://fontbureau.github.io/TypeRoof/live/adapter-websocket-to-typeroof/">https://fontbureau.github.io/TypeRoof/live/adapter-websocket-to-typeroof/</a>
in your browser.</p>
<h2><a id="user-content-run-with-polling" class="anchor" href="#run-with-polling" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Run with Polling</h2>
<p>There are two or three individual steps involved:</p>
<ul>
<li><a href="#polling-part-1-server">Polling Part 1: Server</a></li>
<li><a href="#polling-part-2-adapter">Polling Part 2: Adapter</a></li>
<li>(optionally) <a href="#part-3-file-rotation">Part 3: File Rotation</a></li>
</ul>
<h3><a id="user-content-polling-part-1-server" class="anchor" href="#polling-part-1-server" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Polling Part 1: Server</h3>
<p>Start a simple web-server. NOTE: there are cross-origin restrictions involved
with this technique, which is why the adapter and the polling must come
from the same origin or the server would have to send <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">Cross-Origin Resource Sharing (CORS)</a>
headers.</p>
<pre><code># You don't need the virtual environment for this

$ ~/path/to/TypeRoof/live &gt; python3 -m http.server 8000
Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...
</code></pre>
<h3><a id="user-content-polling-part-2-adapter" class="anchor" href="#polling-part-2-adapter" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Polling Part 2: Adapter</h3>
<p>See <a href="#adapters-usage">Adapters Usage</a>.</p>
<p>Since the web server is already started you only need to open <a href="http://0.0.0.0:8000/adapter-polling-to-typeroof.html">http://0.0.0.0:8000/adapter-polling-to-typeroof.html</a>
in your browser.</p>
<p>The main purpose of this adapter is to serve as an example, thus there
are some assumptions hard-coded into this adapter:</p>
<ul>
<li>The fonts are located at ‘<a href="http://0.0.0.0:8000/fonts/">http://0.0.0.0:8000/fonts/</a>’</li>
<li>Looking for one font only called <code>live-font.ttf</code></li>
</ul>
<p>You can change these assumptions in the JavaScript of the adapter, but
for general usage the <a href="#run-with-websocket">Run with WebSocket</a> example
might be working out of the box.</p>
<p>See <a href="#adapters-usage">All Adapters Usage</a>.</p>
<h2><a id="user-content-part-3-file-rotation" class="anchor" href="#part-3-file-rotation" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Part 3: File Rotation</h2>
<p>This is optional as a demo. To observe file changes created e.g. by a
font-editor, Part 1 and Part 2 are  sufficient.</p>
<p>If you don’t have a source directory for a changing font file that you want
to see updated in TypeRoof, i.e. a font updated by an editor or build process,
this script can “rotate” all font files from a source directory into a single
file in a target directory and thus trigger file-change events.</p>
<pre><code># With the activated virtual environment.

# Rotate the files in &quot;../lib/assets/fonts/*&quot; as &quot;live-font.ttf&quot; in &quot;the&quot;
# ./fonts directory every two seconds. NOTE especially the `-f` flag
# that is meant as safeguard to prevent accidental change to essential
# data.
(venv) $ ~/path/to/TypeRoof/live &gt; ./file_rotation.py -f -s 2 -t live-font.ttf ./fonts/ ../lib/assets/fonts/*

# There's an online help in the tool:
(venv) $ ~/path/to/TypeRoof/live &gt;  ./file_rotation.py
usage: file_rotation.py [-h] [-t TARGET_FILE_NAME] [-f] [-s SECONDS] target_dir source_files [source_files ...]

Rotate font files between target dir and the source directories.

positional arguments:
  target_dir            Target directory name, will be created. Use --force if it exist and its contents can be overridden.
  source_files          Paths to each source files. Each file path will function as a source for the contents in target dir in rotation.

options:
  -h, --help            show this help message and exit
  -t TARGET_FILE_NAME, --target-file TARGET_FILE_NAME
                        Target file name, must not contain the slash character&quot;/&quot; (default: SampleFont.ttf)
  -f, --force           If target_dir exists, allow to change its contents.
  -s SECONDS, --seconds SECONDS
                        number of seconds between rotations (default: 7)
</code></pre>
</div>
            </div>
            <footer>
                <ul>
                    <li><a href="https://github.com/FontBureau/TypeRoof">Source code on GitHub</a></li><!--
                    --><li><a href="https://github.com/FontBureau/TypeRoof/issues">Bug reports &amp; feature&nbsp;requests</a></li>
                </ul>
            </footer>
        </div> <!-- wrapper -->
    </body>
</html>
