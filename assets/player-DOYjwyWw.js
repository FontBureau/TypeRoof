var _=Object.defineProperty;var o=(s,e)=>_(s,"name",{value:e,configurable:!0});import{I as g,J as f,V as v,w as b,T,x as P,a as L,y as S,P as A,n as V,o as E,F as M,B as O,D as C,H as F,c as l,O as w}from"./type-tools-grid-D8GbyQhN.js";const a=Symbol("LAYOUT_GROUP_DEFAULT"),c=Object.fromEntries([[a,{label:"TypeRoof Original"}]].map(([s,e],t)=>[s,Object.freeze(Object.assign({},e,{index:t}))]));Object.defineProperty(c,"default",{value:a,enumerable:!1});Object.freeze(c);const h=Object.freeze([["StageAndActors","Stage and Actors",f,a],["VideoproofArrayDev","Videoproof Array (Interim)",v,a],["VideoproofArray","Array",b,a],["TypeToolsGrid","Grid",T,a],["TypeSpecRamp","TypeSpec - Ramp",P,a]]);function m(s,e,t,...i){s.addEventListener(e,t,...i)}o(m,"_addListener");function u(s,e,t,...i){s.removeEventListener(e,t,...i)}o(u,"_removeListener");class U extends l{static{o(this,"UIVisibilityManager")}visibleClass="visible";constructor(e,t){super(e),this._isPlayingPath=t,this.node=e.wrapper.host,this._timeout=null,this._listenerPointermove=null,this._listenerPointerleave=null,this._mode=null;for(const i of["screengrab","no-chrome"])if(e.uiFlags.has(i)){this.setMode(i);break}this._mode===null&&this.setMode("default")}setMode(e){this._mode=e;const t=this.getEntry("/"),i=w(t,this._isPlayingPath,{value:!0}).value;this.setPlayingState(i)}_startListening(){this._listenerPointermove===null&&(this._listenerPointermove=[this.node,"pointermove",()=>this._addVisibilityAndTimeout()],m(...this._listenerPointermove),this._listenerPointerleave=[this.node,"pointerleave",()=>this._removeVisibilty()],m(...this._listenerPointerleave))}_stopListening(){this._listenerPointermove!==null&&(u(...this._listenerPointermove),this._listenerPointermove=null,u(...this._listenerPointerleave),this._listenerPointerleave=null)}_addVisibilityAndTimeout(e=1500){this._addVisibility(),this._cancelTimeout(),this._timeout=this._domTool.window.setTimeout(this._removeVisibilty.bind(this),e)}_cancelTimeout(){this._timeout!==null&&this._domTool.window.clearTimeout(this._timeout),this._timeout=null}_addVisibility(){this.node.classList.add(this.visibleClass)}_removeVisibilty(){this.node.classList.remove(this.visibleClass)}destroy(){this._cancelTimeout(),this._stopListening(),this._removeVisibilty(),super.destroy()}_toggleVisibilityAutomatic(e,t=!0){e?(this._startListening(),t?this._addVisibilityAndTimeout(0):this._removeVisibilty()):(this._cancelTimeout(),this._stopListening(),t?this._addVisibility():this._removeVisibilty())}setPlayingState(e){let t,i=!0;this._mode==="no-chrome"?(t=!1,i=!1):this._mode==="screengrab"?t=!0:t=e,this._toggleVisibilityAutomatic(t,i)}}class z extends l{static{o(this,"MonitorPlayingState")}constructor(e,t){super(e),this._onChange=t}update(e){if(e.has("playing")){const t=e.get("playing").value;this._onChange(t)}}}class D extends l{static{o(this,"ToggleFullscreen")}static TEMPLATE='<button class="ui_toggle_fullscreen">Toggle Fullscreen</button>';constructor(e,t){super(e),this._element=this._initTemplate(t)}_initTemplate(e){const t=this._domTool.createFragmentFromHTML(this.constructor.TEMPLATE).firstElementChild;return this._insertElement(t),t.addEventListener("click",()=>{if(document.fullscreenElement){document.exitFullscreen();return}e.requestFullscreen().catch(i=>{console.error(`${this} Error enabling fullscreen: ${i.message}`)})}),[t]}}class I extends L{static{o(this,"MainUIController")}constructor(e){const t=new Map([["main",".typeroof-ui_main"],["after-main",".typeroof-ui_main-after"],["before-layout",".typeroof-layout-before"],["layout",".typeroof-layout"],["after-layout",".typeroof-layout-after"],["wrapper","body .wrapper"]].map(([n,d])=>[n,e.domTool.document.querySelector(d)])),i=e.domTool.createElement("fieldset",{class:"application-meta"});t.set("application-meta",i),S(i,"legend");const r=A.fromParts(".","activeState"),y=[[{zone:"wrapper",id:"visibility-manager"},[],U,r.append("playing")],[{rootPath:r,zone:"main",activationTest:o(()=>this.widgetBus.getEntry(r).has("playing"),"activationTest")},["playing"],z,function(n){this.widgetBus.getWidgetById("visibility-manager").setPlayingState(n)}],...h.map(([,,n])=>[{rootPath:r,zone:"main",activationTest:o(()=>this.widgetBus.getEntry(r).WrappedType===n.Model,"activationTest")},[],n.Controller,t]),[{zone:"after-main"},[],D,e.domTool.document.body],[{zone:"after-main"},[],V,i],[{zone:"application-meta"},[],E,"legend",{},"Application Meta"],[{zone:"application-meta"},[["availableFonts","options"],"activeFontKey"],M],[{zone:"application-meta"},[["availableFonts"]],O,[[C,"Manage fonts"],[F,"save / load / share"]]]];super(e,t,y)}get dependencies(){const e=super.dependencies;return e.add("/activeState"),e}get modelDependencies(){const e=super.modelDependencies;return e.add("/activeState"),e}}function p(){x.setInitialDependency("ready",!0)}o(p,"main");const x=new g(window,{MainUIController:I,Layouts:h,LAYOUT_GROUPS:c});document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p();
