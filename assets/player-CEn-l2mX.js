var f=Object.defineProperty;var n=(s,e)=>f(s,"name",{value:e,configurable:!0});import{I as v,J as b,V as T,w as P,T as S,x as L,a as A,y as V,P as E,n as u,F as M,o as O,B as C,D as F,H as w,c,O as z}from"./type-tools-grid-vsRNYX9m.js";const a=Symbol("LAYOUT_GROUP_DEFAULT"),d=Object.fromEntries([[a,{label:"TypeRoof Original"}]].map(([s,e],t)=>[s,Object.freeze(Object.assign({},e,{index:t}))]));Object.defineProperty(d,"default",{value:a,enumerable:!1});Object.freeze(d);const _=Object.freeze([["StageAndActors","Stage and Actors",b,a],["VideoproofArrayDev","Videoproof Array (Interim)",T,a],["VideoproofArray","Array",P,a],["TypeToolsGrid","Grid",S,a],["TypeSpecRamp","TypeSpec - Ramp",L,a]]);function p(s,e,t,...i){s.addEventListener(e,t,...i)}n(p,"_addListener");function h(s,e,t,...i){s.removeEventListener(e,t,...i)}n(h,"_removeListener");class U extends c{static{n(this,"UIVisibilityManager")}visibleClass="visible";constructor(e,t){super(e),this._isPlayingPath=t,this.node=e.wrapper.host,this._timeout=null,this._listenerPointermove=null,this._listenerPointerleave=null,this._mode=null;for(const i of["screengrab","no-chrome"])if(e.uiFlags.has(i)){this.setMode(i);break}this._mode===null&&this.setMode("default")}setMode(e){this._mode=e;const t=this.getEntry("/"),i=z(t,this._isPlayingPath,{value:!0}).value;this.setPlayingState(i)}_startListening(){this._listenerPointermove===null&&(this._listenerPointermove=[this.node,"pointermove",()=>this._addVisibilityAndTimeout()],p(...this._listenerPointermove),this._listenerPointerleave=[this.node,"pointerleave",()=>this._removeVisibilty()],p(...this._listenerPointerleave))}_stopListening(){this._listenerPointermove!==null&&(h(...this._listenerPointermove),this._listenerPointermove=null,h(...this._listenerPointerleave),this._listenerPointerleave=null)}_addVisibilityAndTimeout(e=1500){this._addVisibility(),this._cancelTimeout(),this._timeout=this._domTool.window.setTimeout(this._removeVisibilty.bind(this),e)}_cancelTimeout(){this._timeout!==null&&this._domTool.window.clearTimeout(this._timeout),this._timeout=null}_addVisibility(){this.node.classList.add(this.visibleClass)}_removeVisibilty(){this.node.classList.remove(this.visibleClass)}destroy(){this._cancelTimeout(),this._stopListening(),this._removeVisibilty(),super.destroy()}_toggleVisibilityAutomatic(e,t=!0){e?(this._startListening(),t?this._addVisibilityAndTimeout(0):this._removeVisibilty()):(this._cancelTimeout(),this._stopListening(),t?this._addVisibility():this._removeVisibilty())}setPlayingState(e){let t,i=!0;this._mode==="no-chrome"?(t=!1,i=!1):this._mode==="screengrab"?t=!0:t=e,this._toggleVisibilityAutomatic(t,i)}}class D extends c{static{n(this,"MonitorPlayingState")}constructor(e,t){super(e),this._onChange=t}update(e){if(e.has("playing")){const t=e.get("playing").value;this._onChange(t)}}}class I extends c{static{n(this,"ToggleFullscreen")}static TEMPLATE='<button class="ui_toggle_fullscreen">Toggle Fullscreen</button>';constructor(e,t){super(e),this._element=this._initTemplate(t)}_initTemplate(e){const t=this._domTool.createFragmentFromHTML(this.constructor.TEMPLATE).firstElementChild;return this._insertElement(t),t.addEventListener("click",()=>{if(document.fullscreenElement){document.exitFullscreen();return}e.requestFullscreen().catch(i=>{console.error(`${this} Error enabling fullscreen: ${i.message}`)})}),[t]}}class x extends A{static{n(this,"MainUIController")}constructor(e){const t=new Map([["main",".typeroof-ui_main"],["after-main",".typeroof-ui_main-after"],["before-layout",".typeroof-layout-before"],["layout",".typeroof-layout"],["after-layout",".typeroof-layout-after"],["wrapper","body .wrapper"]].map(([o,m])=>[o,e.domTool.document.querySelector(m)])),i=e.domTool.createElement("fieldset",{class:"general-settings"}),l=e.domTool.createElement("fieldset",{class:"application-meta"});t.set("general-settings",i),t.set("application-meta",l),V(l,"legend");const r=E.fromParts(".","activeState"),g=[[{zone:"wrapper",id:"visibility-manager"},[],U,r.append("playing")],[{rootPath:r,zone:"main",activationTest:n(()=>this.widgetBus.getEntry(r).has("playing"),"activationTest")},["playing"],D,function(o){this.widgetBus.getWidgetById("visibility-manager").setPlayingState(o)}],..._.map(([,,o])=>[{rootPath:r,zone:"main",activationTest:n(()=>this.widgetBus.getEntry(r).WrappedType===o.Model,"activationTest")},[],o.Controller,t]),[{zone:"main"},[],u,i],[{zone:"general-settings"},[["availableFonts","options"],"activeFontKey"],M],[{zone:"general-settings"},[],I,e.domTool.document.body],[{zone:"after-main"},[],u,l],[{zone:"application-meta"},[],O,"legend",{},"Application Meta"],[{zone:"application-meta"},[["availableFonts"]],C,[[F,"Manage fonts"],[w,"Save / Load / Share"]]]];super(e,t,g)}get dependencies(){const e=super.dependencies;return e.add("/activeState"),e}get modelDependencies(){const e=super.modelDependencies;return e.add("/activeState"),e}}function y(){R.setInitialDependency("ready",!0)}n(y,"main");const R=new v(window,{MainUIController:x,Layouts:_,LAYOUT_GROUPS:d});document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y();
